\subsection{Slow Orbit Feedback}

The slow orbit feedback (SOFB) system software is an example of a HLA that has already been written for Sirius. It consists of two modules: a machine application that reads BPMs and controls orbit correctors and a user graphical interface application.

The first one is responsible for all data processing and control, such as orbit/response matrix measurements and orbit corrections based on singular value decomposition (SVD). Standard useful functionalities were implemented: device selection, response matrix and reference orbit configurations, variable-size buffers with orbit data for averages, optional inclusion of RF frequency in the correction loop and corrector strength adjustments. These functionalities were implemented in Python modules that are imported in a PCASpy SOFB server. Python threads were used to allow for uninterrupted CA service while data processing and calculations are performed in response to prior user interactions.

As depicted in Fig.~\ref{fig:sofbf1}, the second SOFB module is a user-friendly GUI application with a CA client layer underneath that allows for monitoring and controlling the SOFB system with embedded graphics tools, thus facilitating machine commissioning and operation. This module was designed in CS-Studio and it interacts with the SOFB machine application module through a set of PVs.

The prototype application is shown in Fig.~\ref{fig:sofbf1}. Its design was based on the orbit correction interface that is being used in the existing UVX storage ring at LNLS which has a proprietary control system. The main features of the prototype application are plot displayed with measured orbit, widgets set for manual correction, the machine application mode selection and widgets for configuring sampling parameters for orbit average calculations. Although not all functionalities have been implemented on the client application yet, the current version should suffice for initial commissioning stages of the storage ring. Selection of BPMs and correctors for the correction algorithm, as well as response matrix and reference orbit configurations, will be added in the near future.

\begin{figure}[!htb]
%   \vspace*{-.5\baselineskip}
   \centering
   \includegraphics*[width=230pt]{WEPOPRPO22f3}
   \caption{Orbit correction display application in the CS-Studio environment.}
   \label{fig:sofbf1}
%   \vspace*{-\baselineskip}
\end{figure}